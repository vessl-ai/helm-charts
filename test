    - job_name: serviceMonitor/vessl/vessl-dcgm-servicemonitor/0
      honor_labels: true
      kubernetes_sd_configs:
      - role: endpoints
        namespaces:
          names:
          - vessl
      metrics_path: /metrics
      relabel_configs:
      - source_labels:
        - job
        target_label: __tmp_prometheus_job_name
      - action: keep
        source_labels:
        - __meta_kubernetes_service_label_v1_k8s_vessl_ai_type
        - __meta_kubernetes_service_labelpresent_v1_k8s_vessl_ai_type
        regex: (dcgm-exporter);true
      - action: keep
        source_labels:
        - __meta_kubernetes_endpoint_port_name
        regex: metrics
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Node;(.*)
        replacement: ${1}
        target_label: node
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Pod;(.*)
        replacement: ${1}
        target_label: pod
      - source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: service
      - source_labels:
        - __meta_kubernetes_pod_name
        target_label: pod
      - source_labels:
        - __meta_kubernetes_pod_container_name
        target_label: container
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: job
        replacement: ${1}
      - target_label: endpoint
        replacement: metrics
      - source_labels:
        - __meta_kubernetes_pod_node_name
        separator: ;
        target_label: nodename
        regex: ^(.*)$
        replacement: $1
        action: replace
      - regex: feature_node_kubernetes_io_(.+)
        action: labeldrop
      - source_labels:
        - __address__
        target_label: __tmp_hash
        modulus: 1
        action: hashmod
      - source_labels:
        - __tmp_hash
        regex: 0
        action: keep
      metric_relabel_configs:
      - regex: ^(Hostname|instance)$
        action: labeldrop
    - job_name: serviceMonitor/vessl/vessl-kube-state-metrics-servicemonitor/0
      honor_labels: true
      kubernetes_sd_configs:
      - role: endpoints
        namespaces:
          names:
          - vessl
      metrics_path: /metrics
      relabel_configs:
      - source_labels:
        - job
        target_label: __tmp_prometheus_job_name
      - action: keep
        source_labels:
        - __meta_kubernetes_service_label_v1_k8s_vessl_ai_type
        - __meta_kubernetes_service_labelpresent_v1_k8s_vessl_ai_type
        regex: (kube-state-metrics);true
      - action: keep
        source_labels:
        - __meta_kubernetes_endpoint_port_name
        regex: metrics
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Node;(.*)
        replacement: ${1}
        target_label: node
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Pod;(.*)
        replacement: ${1}
        target_label: pod
      - source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: service
      - source_labels:
        - __meta_kubernetes_pod_name
        target_label: pod
      - source_labels:
        - __meta_kubernetes_pod_container_name
        target_label: container
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: job
        replacement: ${1}
      - target_label: endpoint
        replacement: metrics
      - regex: feature_node_kubernetes_io_(.+)
        action: labeldrop
      - source_labels:
        - __address__
        target_label: __tmp_hash
        modulus: 1
        action: hashmod
      - source_labels:
        - __tmp_hash
        regex: 0
        action: keep
      metric_relabel_configs:
      - source_labels:
        - __name__
        regex: (kube_pod_container_resource_requests|kube_pod_container_resource_limits|kube_pod_labels|kube_node_status_capacity|kube_node_status_allocatable|kube_persistentvolume_(.+)|kube_persistentvolumeclaim_(.+)|kube_pod_status_phase|kube_pod_info)
        action: keep
      - source_labels:
        - node
        separator: ;
        target_label: nodename
        regex: ^(.*)$
        replacement: $1
        action: replace
      - regex: ^(pod|namespace|(.*)_vessl_ai_(.*)|__(.+)__|nodename|node|resource|phase|(.+)_k8s_vessl_ai_(.+))$
        action: labelkeep
      - regex: label_(.+)_k8s_vessl_ai_(.+)
        replacement: ${1}_k8s_vessl_ai_${2}
        action: labelmap
    - job_name: serviceMonitor/vessl/vessl-model-service-servicemonitor/0
      honor_labels: true
      kubernetes_sd_configs:
      - role: endpoints
      metrics_path: /metrics
      relabel_configs:
      - source_labels:
        - job
        target_label: __tmp_prometheus_job_name
      - action: keep
        source_labels:
        - __meta_kubernetes_service_label_v1_k8s_vessl_ai_serving_metrics_enabled
        - __meta_kubernetes_service_labelpresent_v1_k8s_vessl_ai_serving_metrics_enabled
        regex: (true);true
      - action: keep
        source_labels:
        - __meta_kubernetes_endpoint_port_name
        regex: metrics
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Node;(.*)
        replacement: ${1}
        target_label: node
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Pod;(.*)
        replacement: ${1}
        target_label: pod
      - source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: service
      - source_labels:
        - __meta_kubernetes_pod_name
        target_label: pod
      - source_labels:
        - __meta_kubernetes_pod_container_name
        target_label: container
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: job
        replacement: ${1}
      - target_label: endpoint
        replacement: metrics
      - source_labels:
        - __address__
        target_label: __tmp_hash
        modulus: 1
        action: hashmod
      - source_labels:
        - __tmp_hash
        regex: 0
        action: keep
      metric_relabel_configs:
      - source_labels:
        - __name__
        regex: (bentoml_(.+)|BENTOML_(.+)|nv_(.+)|)
        action: keep
    - job_name: serviceMonitor/vessl/vessl-node-exporter-servicemonitor/0
      honor_labels: true
      kubernetes_sd_configs:
      - role: endpoints
        namespaces:
          names:
          - vessl
      metrics_path: /metrics
      relabel_configs:
      - source_labels:
        - job
        target_label: __tmp_prometheus_job_name
      - action: keep
        source_labels:
        - __meta_kubernetes_service_label_v1_k8s_vessl_ai_type
        - __meta_kubernetes_service_labelpresent_v1_k8s_vessl_ai_type
        regex: (node-exporter);true
      - action: keep
        source_labels:
        - __meta_kubernetes_endpoint_port_name
        regex: metrics
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Node;(.*)
        replacement: ${1}
        target_label: node
      - source_labels:
        - __meta_kubernetes_endpoint_address_target_kind
        - __meta_kubernetes_endpoint_address_target_name
        separator: ;
        regex: Pod;(.*)
        replacement: ${1}
        target_label: pod
      - source_labels:
        - __meta_kubernetes_namespace
        target_label: namespace
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: service
      - source_labels:
        - __meta_kubernetes_pod_name
        target_label: pod
      - source_labels:
        - __meta_kubernetes_pod_container_name
        target_label: container
      - source_labels:
        - __meta_kubernetes_service_name
        target_label: job
        replacement: ${1}
      - target_label: endpoint
        replacement: metrics
      - source_labels:
        - __meta_kubernetes_pod_node_name
        separator: ;
        target_label: nodename
        regex: ^(.*)$
        replacement: $1
        action: replace
      - regex: feature_node_kubernetes_io_(.+)
        action: labeldrop
      - regex: ^pod$
        action: labeldrop
      - source_labels:
        - __address__
        target_label: __tmp_hash
        modulus: 1
        action: hashmod
      - source_labels:
        - __tmp_hash
        regex: 0
        action: keep
      metric_relabel_configs:
      - source_labels:
        - __name__
        regex: (node_filesystem_avail_bytes|node_filesystem_size_bytes|node_ethtool_info|node_network_info|node_network_receive_bytes_total|node_network_transmit_bytes_total|node_network_route_info)
        action: keep
      - regex: ^instance$
        action: labeldrop
    - job_name: kubernetes-nodes-kubelet
      scheme: https
      kubernetes_sd_configs:
      - role: node
      tls_config:
        ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        insecure_skip_verify: true
      bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
      relabel_configs:
      - action: labelmap
        regex: __meta_kubernetes_node_label_(.+)
      - target_label: __address__
        replacement: kubernetes.default.svc:443
      - source_labels:
        - __meta_kubernetes_node_name
        regex: (.+)
        target_label: __metrics_path__
        replacement: /api/v1/nodes/$1/proxy/metrics/cadvisor
      - regex: (.*)nvidia_com_gfd_timestamp
        action: labeldrop
      - regex: feature_node_kubernetes_io_(.+)
        action: labeldrop
      - regex: nvidia_com_(.+)
        action: labeldrop
      - source_labels:
        - instance
        separator: ;
        regex: ^(.*)$
        target_label: nodename
        replacement: $1
        action: replace
      metric_relabel_configs:
      - source_labels:
        - __name__
        regex: (kubelet_volume_stats_used_bytes|kubelet_volume_stats_capacity_bytes)
        action: keep
    - job_name: kubernetes-nodes-cadvisor
      scheme: https
      tls_config:
        ca_file: /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
        insecure_skip_verify: true
      bearer_token_file: /var/run/secrets/kubernetes.io/serviceaccount/token
      kubernetes_sd_configs:
      - role: node
      metric_relabel_configs:
      - source_labels:
        - __name__
        regex: (container_cpu_usage_seconds_total|container_network_receive_bytes_total|container_network_transmit_bytes_total|container_memory_working_set_bytes|container_fs_usage_bytes)
        action: keep
      relabel_configs:
      - action: labelmap
        regex: __meta_kubernetes_node_label_(.+)
      - target_label: __address__
        replacement: kubernetes.default.svc:443
      - source_labels:
        - __meta_kubernetes_node_name
        regex: (.+)
        target_label: __metrics_path__
        replacement: /api/v1/nodes/$1/proxy/metrics/cadvisor
      - regex: (.*)nvidia_com_gfd_timestamp
        action: labeldrop
      - regex: feature_node_kubernetes_io_(.+)
        action: labeldrop
      - regex: nvidia_com_(.+)
        action: labeldrop
      - source_labels:
        - instance
        separator: ;
        regex: ^(.*)$
        target_label: nodename
        replacement: $1
        action: replace